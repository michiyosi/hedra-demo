<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Hedra Live Avatars 体験リンク（デモ）</title>
  <style>
    :root{
      --bg:#0b1020; --card:#111833; --ink:#eaf0ff; --muted:#a7b0c8; --accent:#6ca0ff; --ok:#25d366; --warn:#ffd166;
    }
    *{box-sizing:border-box}
    body{margin:0; background:radial-gradient(1200px 600px at 20% -10%,#1a2346 0%, #0b1020 55%, #0b1020 100%); color:var(--ink); font-family:ui-sans-serif, system-ui, -apple-system, "Segoe UI", "Noto Sans JP", "Hiragino Kaku Gothic ProN", Meiryo, sans-serif;}
    .wrap{max-width:960px; margin:40px auto; padding:0 20px;}
    header{display:flex; gap:12px; align-items:center; margin-bottom:18px}
    .logo{width:36px;height:36px;border-radius:10px;background:linear-gradient(135deg,#6ca0ff, #7affd5)}
    h1{font-size:28px; margin:0}
    .card{background:rgba(17,24,51,.78); backdrop-filter: blur(6px); border:1px solid rgba(255,255,255,.08); border-radius:16px; padding:20px}
    .row{display:grid; grid-template-columns:1fr 1fr; gap:20px}
    @media (max-width:820px){ .row{grid-template-columns:1fr} }
    label{display:block; color:var(--muted); font-size:14px; margin-bottom:6px}
    input{width:100%; padding:12px 14px; border:1px solid rgba(255,255,255,.12); border-radius:12px; background:#0d142a; color:var(--ink)}
    .video{
      position:relative; border-radius:16px; overflow:hidden; height:360px;
      background:linear-gradient(135deg, #0d142a, #101a35);
      border:1px solid rgba(255,255,255,.08);
    }
    /* “映像っぽい”アニメ背景 */
    .scan{position:absolute; inset:0; background:repeating-linear-gradient( to bottom, rgba(255,255,255,.06) 0 2px, transparent 2px 6px ); animation:scan 6s linear infinite;}
    @keyframes scan{from{transform:translateY(-60px)} to{transform:translateY(60px)}}
    .avatar-badge{
      position:absolute; top:12px; left:12px; display:flex; gap:10px; align-items:center; background:rgba(8,12,28,.7);
      backdrop-filter: blur(6px); border:1px solid rgba(255,255,255,.1); padding:8px 12px; border-radius:999px; font-size:13px; color:#d9e4ff;
    }
    .pulse{width:10px;height:10px;border-radius:999px;background:var(--warn); animation:pulse 1.2s ease-in-out infinite}
    @keyframes pulse{0%{box-shadow:0 0 0 0 rgba(255,209,102,.7)}70%{box-shadow:0 0 0 10px rgba(255,209,102,0)}100%{box-shadow:0 0 0 0 rgba(255,209,102,0)}}
    .overlay-text{position:absolute; inset:0; display:grid; place-items:center; color:#cbd6ff; text-align:center}
    .overlay-text small{display:block; color:var(--muted)}
    .controls{display:flex; gap:12px; flex-wrap:wrap; margin-top:14px}
    button{appearance:none; cursor:pointer; padding:12px 16px; border-radius:12px; border:1px solid rgba(255,255,255,.12); background:#0d142a; color:var(--ink)}
    button.primary{background:linear-gradient(135deg,#6ca0ff,#7affd5); color:#0b1020; border:none; font-weight:600}
    button.ghost{background:transparent}
    .status{margin-top:12px; color:var(--muted); font-size:14px}
    .ok{color:var(--ok)} .err{color:#ff6b6b}
    footer{opacity:.7; font-size:13px; margin-top:24px}
    .pill{display:inline-flex; align-items:center; gap:8px; padding:6px 10px; border-radius:999px; background:rgba(255,255,255,.06); border:1px solid rgba(255,255,255,.08)}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="logo"></div>
      <h1>Hedra Live Avatars 体験リンク <span class="pill">デモUI</span></h1>
    </header>

    <div class="row">
      <!-- 左：映像エリア -->
      <div class="card">
        <div class="video" id="videoBox">
          <div class="scan"></div>
          <div class="avatar-badge"><div class="pulse" id="dot"></div><span id="badge">待機中</span></div>
          <div class="overlay-text" id="overlay">
            <div>
              <div style="font-size:18px; font-weight:600;">ここに「アバターの映像」が表示されます</div>
              <small>（デモ表示／LiveKit未接続）</small>
            </div>
          </div>
        </div>
        <div class="controls">
          <button class="primary" id="btnConnect">接続する（デモ）</button>
          <button class="ghost" id="btnMic">マイク許可（デモ）</button>
          <button class="ghost" id="btnReset">リセット</button>
        </div>
        <div class="status" id="status">状態：未接続</div>
      </div>

      <!-- 右：設定エリア -->
      <div class="card">
        <div style="margin-bottom:14px">
          <label>表示名</label>
          <input id="name" placeholder="例：Guest A" />
        </div>

        <div style="display:grid; grid-template-columns:1fr 1fr; gap:12px">
          <div>
            <label>音声</label>
            <div class="pill">日本語 / 自動</div>
          </div>
          <div>
            <label>表情</label>
            <div class="pill">標準（デモ）</div>
          </div>
        </div>

        <footer>
          <p>これは <strong>ダミーUI</strong> です。LiveKit 連携前の見た目確認用。<br/>のちほど <code>/api/getToken</code> に接続して本番化します。</p>
        </footer>
      </div>
    </div>
  </div>

  <!-- デモ用スクリプト：見た目だけ“動いている風” -->
  <script>
    const $ = (id)=>document.getElementById(id);
    const status = (msg, cls)=>{$("status").textContent="状態："+msg; $("status").className="status "+(cls||"")}

    $("btnConnect").onclick = async ()=>{
      const name = $("name").value || "Guest";
      status("接続準備中…"); $("badge").textContent="接続準備"; $("dot").style.background="#ffd166";
      await wait(600);
      status(`接続中：${name} を登録…`); await wait(800);
      status("ルーム参加（デモ）"); await wait(600);
      // デモ：オーバーレイ文言を変更
      $("overlay").innerHTML = `<div><div style="font-size:18px;font-weight:600;">接続しました（デモ）</div><small>相手の映像が届くとここに表示されます</small></div>`;
      $("badge").textContent="オンライン（デモ）"; $("dot").style.background="#25d366";
    };

    $("btnMic").onclick = async ()=>{
      status("マイク権限を確認（デモ）");
      // 実機では navigator.mediaDevices.getUserMedia({audio:true}) を呼びます
      await wait(500);
      status("マイクOK（デモ）","ok");
    };

    $("btnReset").onclick = ()=>{
      $("overlay").innerHTML = `<div><div style="font-size:18px; font-weight:600;">ここに「アバターの映像」が表示されます</div><small>（デモ表示／LiveKit未接続）</small></div>`;
      $("badge").textContent="待機中"; $("dot").style.background="#ffd166";
      status("未接続");
    };

    function wait(ms){ return new Promise(r=>setTimeout(r,ms)); }
  </script>
</body>
</html>
